<div class="container mt-4">
  <h1 class="mb-4 text-left" style="color: #004d00; font-size: 2.3rem; font-weight: bold;">Preguntas y Cursos Destacados</h1>
  
  <div class="row mb-5">
    <div class="col-md-6">
      <div class="card shadow" style="border: 1px solid #e0e0e0; border-radius: 0.5rem; background-color: #f8f9fa;">
        <div class="card-body">
          <h5 class="card-title" style="font-size: 1.25rem; color: #28a745; font-weight: 900;">Pregunta con más errores</h5>
          <p class="card-text">
            <strong><%= @most_wrong_question.question %></strong><br>
            Pertenece a <strong><%= @most_wrong_question.course_name %></strong><br>
            Cantidad de veces respondida incorrectamente: <span style="font-size: 1.25rem; color: #004d00;"><%= @most_wrong_question.wrong_count %></span>
          </p>
        </div>
      </div>
    </div>
    
  <div class="col-md-6">
    <div class="card shadow" style="border: 1px solid #e0e0e0; border-radius: 0.5rem; background-color: #f8f9fa;">
      <div class="card-body">
        <h5 class="card-title" style="font-size: 1.25rem; color: #28a745; font-weight: 900;">Pregunta con más respuestas correctas</h5>
        <p class="card-text">
          <strong><%= @least_wrong_question.question %></strong><br>
          Pertenece a <strong><%= @least_wrong_question.course_name %></strong><br>
          Cantidad de veces respondida correctamente: <span style="font-size: 1.25rem; color: #004d00;"><%= @least_wrong_question.correct_count %></span>
        </p>
      </div>
    </div>
  </div>

  </div>

  <div class="row mb-5">
    <div class="col-md-6">
      <div class="card shadow" style="border: 1px solid #e0e0e0; border-radius: 0.5rem; background-color: #f8f9fa;">
        <div class="card-body">
          <h5 class="card-title" style="font-size: 1.25rem; color: #28a745; font-weight: 900;">Curso con mayor puntaje promedio</h5>
          <p class="card-text">
            <strong><%= @highest_average_score_course.name %></strong><br>
            Puntaje promedio: <span style="font-size: 1.25rem; color: #004d00;"><%= @highest_average_score_course.avg_score.round(2) %></span>
          </p>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card shadow" style="border: 1px solid #e0e0e0; border-radius: 0.5rem; background-color: #f8f9fa;">
        <div class="card-body">
          <h5 class="card-title" style="font-size: 1.25rem; color: #28a745; font-weight: 900;">Curso con menor puntaje promedio</h5>
          <p class="card-text">
            <strong><%= @lowest_average_score_course.name %></strong><br>
            Puntaje promedio: <span style="font-size: 1.25rem; color: #004d00;"><%= @lowest_average_score_course.avg_score.round(2) %></span>
          </p>
        </div>
      </div>
    </div>
  </div>

<!--
-->

  <div style="width: 100%; height: 0.5px; background-color: #004d00; margin: 40px 0;"></div>


  <h1 class="mb-4 text-left" style="color: #004d00; font-size: 2.3rem; font-weight: bold;">Avance de los Estudiantes</h1>

  <div class="row">
    <% @user_progresses.each do |user_progress| %>
      <div class="col-md-4 mb-4">
        <%= link_to user_progress_path(user_progress.user.id), style: "text-decoration: none; color: inherit;" do %>
          <div class="card shadow" style="border: 1px solid #e0e0e0; border-radius: 0.5rem; background-color: #f8f9fa;">
            <div class="card-body">
              <h5 class="card-title" style="font-size: 1.5rem; color: #28a745; font-weight: 900"><%= user_progress.user.name %></h5>
              <% user_view = user_progress.user %>
              <p class="card-text">
                Tiempo de uso:
               <% if user_view.current_sign_in_at.present? %>
                  <% tiempo_uso = user_view.current_sign_in_at - user_view.created_at %>
                  <% horas_uso = (tiempo_uso / 1.hour).to_i %>
                  <strong style="color: #004d00;"> <%= horas_uso %> horas </strong> 
                <% else %>
                  No disponible
                <% end %>
              </p>

              <p class="card-text">
                Puntaje Global: <strong style="font-size: 1.25rem; color: #004d00;"><%= user_progress.score %></strong>
              </p>

              <% @user_courses.where(user_id: user_progress.user_id).each do |user_course| %>
                <div class="d-flex justify-content-between">
                  <span style="font-size: 1rem; color: #333;"><%= user_course.course.name %></span>
                  <span style="font-size: 1rem; color: #333;"><%= user_course.progress * 10 %>%</span>
                </div>
                <div class="progress mb-2" style="height: 1.5rem; background-color: #f8f9fa;">
                  <div class="progress-bar" role="progressbar" style="width: <%= user_course.progress * 10 %>%; background-color: #28a745;" aria-valuenow="<%= user_course.progress * 10 %> " aria-valuemin="0" aria-valuemax="100"></div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
